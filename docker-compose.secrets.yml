version: "3.8"

# Contoh file override yang menunjukkan cara menyediakan secrets untuk produksi.
# File ini bersifat opsional dan mendemonstrasikan penggunaan file di ./secrets
# (harus dibuat di host dan biasanya diabaikan oleh git).

services:
  db:
    environment:
      # Beberapa image mendukung variabel *_FILE yang mengarah ke path file rahasia.
      # Jika image MariaDB Anda mendukungnya, Anda dapat menggunakan
      # MARIADB_ROOT_PASSWORD_FILE atau MYSQL_ROOT_PASSWORD_FILE daripada
      # menaruh rahasia di environment biasa.
      # Di sini contoh rahasia dipasang ke /run/secrets/
      - MARIADB_ROOT_PASSWORD_FILE=/run/secrets/mariadb_root_password
      - MYSQL_PASSWORD_FILE=/run/secrets/nextcloud_db_password
    secrets:
      - mariadb_root_password
      - nextcloud_db_password

  app:
    environment:
      - MYSQL_PASSWORD_FILE=/run/secrets/nextcloud_db_password
    secrets:
      - nextcloud_db_password

secrets:
  mariadb_root_password:
    file: ./secrets/mariadb_root_password.txt
  nextcloud_db_password:
    file: ./secrets/nextcloud_db_password.txt
